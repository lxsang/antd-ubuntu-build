(function(){var n,s,t,e,i,r,a=function(t,e){for(var n in e)p.call(e,n)&&(t[n]=e[n]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t},p={}.hasOwnProperty;e=function(){function t(t,e){this.scheme=t,this.parent=e}return t.prototype.find=function(t){if(this.scheme)return $("[data-id='"+t+"']",this.scheme)[0]},t.prototype.render=function(){},t}(),(t=function(t){function e(t){e.__super__.constructor.call(this,"Setting",t)}return a(e,t),e.prototype.main=function(){var e;return(e=this).container=this.find("container"),this.container.setTabs([{text:"__(Appearance)",iconclass:"fa fa-paint-brush",url:this.path()+"/schemes/appearance.html",handler:function(t){return new n(t,e)}},{text:"__(VFS)",iconclass:"fa fa-inbox",url:this.path()+"/schemes/vfs.html",handler:function(t){return new r(t,e)}},{text:"__(Languages)",iconclass:"fa fa-globe",url:this.path()+"/schemes/locale.html",handler:function(t){return new s(t,e)}},{text:"__(Startup)",iconclass:"fa fa-cog",url:this.path()+"/schemes/startup.html",handler:function(t){return new i(t,e)}}]),this.find("btnsave").set("onbtclick",function(t){return e._api.setting(function(t){return t.error?e.error(__("Cannot save system setting: {0}",t.error)):e.notify(__("System setting saved"))})})},e}(this.OS.GUI.BaseApplication)).singleton=!0,this.OS.register("Setting",t),n=function(t){function r(t,e){var s,n,i;r.__super__.constructor.call(this,t,e),(s=this).wplist=this.find("wplist"),this.wpreview=this.find("wp-preview"),this.wpsize=this.find("wpsize"),this.wprepeat=this.find("wprepeat"),this.themelist=this.find("theme-list"),this.syswp=void 0,this.wplist.set("onlistselect",function(t){return $(s.wpreview).css("background-image","url("+s.parent._api.handler.get+"/"+t.data.path+")").css("background-size","cover"),s.parent.systemsetting.appearance.wp.url=t.data.path,s.parent._gui.wallpaper()}),this.wplist.set("buttons",[{text:"+",onbtclick:function(t){return s.parent.openDialog("FileDiaLog",function(t,e,n){return s.parent.systemsetting.appearance.wps.push(n),s.render()},__("Select image file"),{mimes:["image/.*"]})}}]),this.wpsize.set("onlistselect",function(t){return s.parent.systemsetting.appearance.wp.size=t.data.text,s.parent._gui.wallpaper()}),i=[{text:"cover",selected:"cover"===s.parent.systemsetting.appearance.wp.size},{text:"auto",selected:"auto"===s.parent.systemsetting.appearance.wp.size},{text:"contain",selected:"contain"===s.parent.systemsetting.appearance.wp.size}],this.wpsize.set("items",i),n=[{text:"repeat",selected:"repeat"===s.parent.systemsetting.appearance.wp.repeat},{text:"repeat-x",selected:"repeat-x"===s.parent.systemsetting.appearance.wp.repeat},{text:"repeat-y",selected:"repeat-y"===s.parent.systemsetting.appearance.wp.repeat},{text:"no-repeat",selected:"no-repeat"===s.parent.systemsetting.appearance.wp.repeat}],this.wprepeat.set("items",n),this.wprepeat.set("onlistselect",function(t){return s.parent.systemsetting.appearance.wp.repeat=t.data.text,s.parent._gui.wallpaper()}),this.themelist.set("items",[{text:"antos",selected:!0}])}return a(r,e),r.prototype.render=function(){var r,a;return(r=this).syswp?r.wplist.set("items",r.getwplist()):(a="os://resources/themes/system/wp").asFileHandler().read(function(t){var e,n,s,i;for(t.error&&r.parent.error(__("Cannot read wallpaper list from {0}",a)),e=0,n=(s=t.result).length;e<n;e++)(i=s[e]).text=i.filename,i.path===r.parent.systemsetting.appearance.wp.url&&(i.selected=!0),i.iconclass="fa fa-file-image-o";return r.syswp=t.result,r.wplist.set("items",r.getwplist())})},r.prototype.getwplist=function(){var t,e,n,s,i;for(s=[],e=0,n=(i=this.parent.systemsetting.appearance.wps).length;e<n;e++)t=i[e].asFileHandler(),s.push({text:t.basename,path:t.path,selected:t.path===this.parent.systemsetting.appearance.wp.url,iconclass:"fa fa-file-image-o"});return s=s.concat(this.syswp)},r}(),r=function(t){function n(t,e){var s;n.__super__.constructor.call(this,t,e),(s=this).mplist=this.find("mplist"),this.dpath=this.find("dpath"),this.ppath=this.find("ppath"),this.mplist.set("buttons",[{text:"+",onbtclick:function(t){return s.parent.openDialog(s.mkdialog(),function(t){return s.parent.systemsetting.VFS.mountpoints.push({text:t.name,path:t.path,iconclass:"fa fa-folder",type:"fs"}),s.render()},"__(Add mount point)")}},{text:"-",onbtclick:function(t){var e,n;if(n=s.mplist.get("selidx"),e=s.mplist.get("selected"),0<=n)return s.parent.openDialog("YesNoDialog",function(t){if(t)return s.parent.systemsetting.VFS.mountpoints.splice(n,1),s.render()},"__(Remove)",{text:__("Remove: {0}?",e.text)})}},{text:"",iconclass:"fa fa-pencil",onbtclick:function(t){var e;if(e=s.mplist.get("selected"))return s.parent.openDialog(s.mkdialog(),function(t){return t.el.text=t.name,t.el.path=t.path,s.render()},"__(Edit mount point)",e)}}]),this.find("btndpath").set("onbtclick",function(t){return s.parent.openDialog("FileDiaLog",function(t,e,n){return s.parent.systemsetting.desktop.path=n,s.parent._gui.refreshDesktop(),s.render()},"__(Select a directory)",{mimes:["dir"],hidden:!0})}),this.find("btnppath").set("onbtclick",function(t){return s.parent.openDialog("FileDiaLog",function(t,e,n){return s.parent.systemsetting.system.pkgpaths.user=n,s.render()},"__(Select a directory)",{mimes:["dir"],hidden:!0})})}return a(n,e),n.prototype.render=function(){return this.mplist.set("items",this.parent.systemsetting.VFS.mountpoints),this.dpath.set("text",this.parent.systemsetting.desktop.path),this.ppath.set("text",this.parent.systemsetting.system.pkgpaths.user)},n.prototype.mkdialog=function(){return this.parent._gui.mkdialog({name:"MountPointDialog",layout:{tags:[{tag:"afx-label",att:'text="__(Name)" data-height="20"'},{tag:"input",att:"type='text' data-height='25'"},{tag:"afx-label",att:'text="__(Path)" data-height="20"'},{tag:"input",att:"type='text' data-height='25'"}],width:250,height:150,resizable:!1,buttons:[{label:"__(Ok)",onclick:function(t){var e;return(e={name:t.find("content1").value,path:t.find("content3").value,el:t.data}).name&&""!==e.name?e.path&&""!==e.path?(t.handler&&t.handler(e),t.quit()):t.error(__("Please select a directory")):t.error(__("Please enter mount point name"))}},{label:"__(Cancel)",onclick:function(t){return t.quit()}}],filldata:function(s){if($(s.find("content3")).click(function(t){return s.openDialog("FileDiaLog",function(t,e,n){return s.find("content3").value=n},"__(Select a directory)",{mimes:["dir"],hidden:!0})}),s.data)return s.data.text&&(s.find("content1").value=s.data.text),s.data.path?s.find("content3").value=s.data.path:void 0}}})},n}(),s=function(t){function s(t,e){var n;s.__super__.constructor.call(this,t,e),(n=this).lglist=this.find("lglist"),this.localelist=void 0,this.lglist.set("onlistselect",function(t){return n.parent._api.setLocale(t.data.text)})}return a(s,e),s.prototype.render=function(){var r;return(r=this).localelist?r.lglist.set("items",r.localelist):"os://resources/languages".asFileHandler().read(function(t){var e,n,s,i;if(t.derror)return r.parent.error(__("Cannot fetch system locales: {0}",t.error));for(e=0,n=(s=t.result).length;e<n;e++)(i=s[e]).text=i.filename.replace(/\.json$/g,""),i.selected=i.text===r.parent.systemsetting.system.locale;return r.localelist=t.result,r.lglist.set("items",r.localelist)})},s}(),i=function(t){function n(t,e){var p;n.__super__.constructor.call(this,t,e),(p=this).srvlist=this.find("srvlist"),this.applist=this.find("applist"),this.srvlist.set("buttons",[{text:"+",onbtclick:function(t){var i,e,n,s,r,a;for(i in n=[],e=p.parent.systemsetting.system.packages)(r=e[i]).services&&(s=function(){var t,e,n,s;for(s=[],t=0,e=(n=r.services).length;t<e;t++)a=n[t],s.push({text:i+"/"+a,iconclass:"fa fa-tasks"});return s}(),n=n.concat(s));return p.parent.openDialog(p.mkdialog(),function(t){return p.parent.systemsetting.system.startup.services.push(t),p.render()},"__(Add service)",n)}},{text:"-",onbtclick:function(t){var e;if(0<=(e=p.srvlist.get("selidx")))return p.parent.systemsetting.system.startup.services.splice(e,1),p.render()}}]),this.applist.set("buttons",[{text:"+",onbtclick:function(t){var e,n,s;return e=function(){var t,e;for(n in e=[],t=p.parent.systemsetting.system.packages)s=t[n],e.push({text:n,iconclass:s.iconclass});return e}(),p.parent.openDialog(p.mkdialog(),function(t){return p.parent.systemsetting.system.startup.apps.push(t),p.render()},"__(Add application)",e)}},{text:"-",onbtclick:function(t){var e;if(0<=(e=p.applist.get("selidx")))return p.parent.systemsetting.system.startup.apps.splice(e,1),p.render()}}])}return a(n,e),n.prototype.render=function(){var i;return this.srvlist.set("items",function(){var t,e,n,s;for(s=[],t=0,e=(n=this.parent.systemsetting.system.startup.services).length;t<e;t++)i=n[t],s.push({text:i});return s}.call(this)),this.applist.set("items",function(){var t,e,n,s;for(s=[],t=0,e=(n=this.parent.systemsetting.system.startup.apps).length;t<e;t++)i=n[t],s.push({text:i});return s}.call(this))},n.prototype.mkdialog=function(){return this.parent._gui.mkdialog({name:"StartupDialog",layout:{tags:[{tag:"afx-list-view"}],width:250,height:200,resizable:!1,buttons:[{label:"__(Ok)",onclick:function(t){var e;return(e=t.find("content0").get("selected"))?(t.handler&&t.handler(e.text),t.quit()):t.error(__("Please select an entry"))}},{label:"__(Cancel)",onclick:function(t){return t.quit()}}],filldata:function(t){if(t.data)return t.find("content0").set("items",t.data)}}})},n}()}).call(this);