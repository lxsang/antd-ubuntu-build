(function(){var t,e,n,s,i,r,a=function(t,e){for(var n in e)p.call(e,n)&&(t[n]=e[n]);function s(){this.constructor=t}return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t},p={}.hasOwnProperty;s=function(){function t(t,e){this.scheme=t,this.parent=e}return t.prototype.find=function(t){if(this.scheme)return $("[data-id='"+t+"']",this.scheme)[0]},t.prototype.render=function(){},t}(),(n=function(n){function s(t){s.__super__.constructor.call(this,"Setting",t)}return a(s,n),s.prototype.main=function(){var n;return n=this,this.container=this.find("container"),this.container.setTabs([{text:"__(Appearance)",iconclass:"fa fa-paint-brush",url:this.path()+"/schemes/appearance.html",handler:function(e){return new t(e,n)}},{text:"__(VFS)",iconclass:"fa fa-inbox",url:this.path()+"/schemes/vfs.html",handler:function(t){return new r(t,n)}},{text:"__(Languages)",iconclass:"fa fa-globe",url:this.path()+"/schemes/locale.html",handler:function(t){return new e(t,n)}},{text:"__(Startup)",iconclass:"fa fa-cog",url:this.path()+"/schemes/startup.html",handler:function(t){return new i(t,n)}}]),this.find("btnsave").set("onbtclick",function(t){return n._api.setting(function(t){return t.error?n.error(__("Cannot save system setting: {0}",t.error)):n.notify(__("System setting saved"))})})},s}(this.OS.GUI.BaseApplication)).singleton=!0,this.OS.register("Setting",n),t=function(t){function e(t,n){var s,i,r;e.__super__.constructor.call(this,t,n),s=this,this.wplist=this.find("wplist"),this.wpreview=this.find("wp-preview"),this.wpsize=this.find("wpsize"),this.wprepeat=this.find("wprepeat"),this.themelist=this.find("theme-list"),this.syswp=void 0,this.wplist.set("onlistselect",function(t){return $(s.wpreview).css("background-image","url("+s.parent._api.handler.get+"/"+t.data.path+")").css("background-size","cover"),s.parent.systemsetting.appearance.wp.url=t.data.path,s.parent._gui.wallpaper()}),this.wplist.set("buttons",[{text:"+",onbtclick:function(t){return s.parent.openDialog("FileDiaLog",function(t,e,n){return s.parent.systemsetting.appearance.wps.push(n),s.render()},__("Select image file"),{mimes:["image/.*"]})}}]),this.wpsize.set("onlistselect",function(t){return s.parent.systemsetting.appearance.wp.size=t.data.text,s.parent._gui.wallpaper()}),r=[{text:"cover",selected:"cover"===s.parent.systemsetting.appearance.wp.size},{text:"auto",selected:"auto"===s.parent.systemsetting.appearance.wp.size},{text:"contain",selected:"contain"===s.parent.systemsetting.appearance.wp.size}],this.wpsize.set("items",r),i=[{text:"repeat",selected:"repeat"===s.parent.systemsetting.appearance.wp.repeat},{text:"repeat-x",selected:"repeat-x"===s.parent.systemsetting.appearance.wp.repeat},{text:"repeat-y",selected:"repeat-y"===s.parent.systemsetting.appearance.wp.repeat},{text:"no-repeat",selected:"no-repeat"===s.parent.systemsetting.appearance.wp.repeat}],this.wprepeat.set("items",i),this.wprepeat.set("onlistselect",function(t){return s.parent.systemsetting.appearance.wp.repeat=t.data.text,s.parent._gui.wallpaper()}),this.themelist.set("items",[{text:"antos",selected:!0}])}return a(e,s),e.prototype.render=function(){var t,e;return t=this,this.syswp?t.wplist.set("items",t.getwplist()):(e="os://resources/themes/system/wp").asFileHandler().read(function(n){var s,i,r,a;for(n.error&&t.parent.error(__("Cannot read wallpaper list from {0}",e)),s=0,i=(r=n.result).length;s<i;s++)(a=r[s]).text=a.filename,a.path===t.parent.systemsetting.appearance.wp.url&&(a.selected=!0),a.iconclass="fa fa-file-image-o";return t.syswp=n.result,t.wplist.set("items",t.getwplist())})},e.prototype.getwplist=function(){var t,e,n,s,i;for(s=[],e=0,n=(i=this.parent.systemsetting.appearance.wps).length;e<n;e++)t=i[e].asFileHandler(),s.push({text:t.basename,path:t.path,selected:t.path===this.parent.systemsetting.appearance.wp.url,iconclass:"fa fa-file-image-o"});return s=s.concat(this.syswp)},e}(),r=function(t){function e(t,n){var s;e.__super__.constructor.call(this,t,n),s=this,this.mplist=this.find("mplist"),this.dpath=this.find("dpath"),this.ppath=this.find("ppath"),this.mplist.set("buttons",[{text:"+",onbtclick:function(t){return s.parent.openDialog(s.mkdialog(),function(t){return s.parent.systemsetting.VFS.mountpoints.push({text:t.name,path:t.path,iconclass:"fa fa-folder",type:"fs"}),s.render()},"__(Add mount point)")}},{text:"-",onbtclick:function(t){var e,n;if(n=s.mplist.get("selidx"),e=s.mplist.get("selected"),n>=0)return s.parent.openDialog("YesNoDialog",function(t){if(t)return s.parent.systemsetting.VFS.mountpoints.splice(n,1),s.render()},"__(Remove)",{text:__("Remove: {0}?",e.text)})}},{text:"",iconclass:"fa fa-pencil",onbtclick:function(t){var e;if(e=s.mplist.get("selected"))return s.parent.openDialog(s.mkdialog(),function(t){return t.el.text=t.name,t.el.path=t.path,s.render()},"__(Edit mount point)",e)}}]),this.find("btndpath").set("onbtclick",function(t){return s.parent.openDialog("FileDiaLog",function(t,e,n){return s.parent.systemsetting.desktop.path=n,s.parent._gui.refreshDesktop(),s.render()},"__(Select a directory)",{mimes:["dir"],hidden:!0})}),this.find("btnppath").set("onbtclick",function(t){return s.parent.openDialog("FileDiaLog",function(t,e,n){return s.parent.systemsetting.system.pkgpaths.user=n,s.render()},"__(Select a directory)",{mimes:["dir"],hidden:!0})})}return a(e,s),e.prototype.render=function(){return this,this.mplist.set("items",this.parent.systemsetting.VFS.mountpoints),this.dpath.set("text",this.parent.systemsetting.desktop.path),this.ppath.set("text",this.parent.systemsetting.system.pkgpaths.user)},e.prototype.mkdialog=function(){return this.parent._gui.mkdialog({name:"MountPointDialog",layout:{tags:[{tag:"afx-label",att:'text="__(Name)" data-height="20"'},{tag:"input",att:"type='text' data-height='25'"},{tag:"afx-label",att:'text="__(Path)" data-height="20"'},{tag:"input",att:"type='text' data-height='25'"}],width:250,height:150,resizable:!1,buttons:[{label:"__(Ok)",onclick:function(t){var e;return(e={name:t.find("content1").value,path:t.find("content3").value,el:t.data}).name&&""!==e.name?e.path&&""!==e.path?(t.handler&&t.handler(e),t.quit()):t.error(__("Please select a directory")):t.error(__("Please enter mount point name"))}},{label:"__(Cancel)",onclick:function(t){return t.quit()}}],filldata:function(t){if($(t.find("content3")).click(function(e){return t.openDialog("FileDiaLog",function(e,n,s){return t.find("content3").value=s},"__(Select a directory)",{mimes:["dir"],hidden:!0})}),t.data)return t.data.text&&(t.find("content1").value=t.data.text),t.data.path?t.find("content3").value=t.data.path:void 0}}})},e}(),e=function(t){function e(t,n){var s;e.__super__.constructor.call(this,t,n),s=this,this.lglist=this.find("lglist"),this.localelist=void 0,this.lglist.set("onlistselect",function(t){return s.parent._api.setLocale(t.data.text)})}return a(e,s),e.prototype.render=function(){var t;return t=this,this.localelist?t.lglist.set("items",t.localelist):("os://resources/languages","os://resources/languages".asFileHandler().read(function(e){var n,s,i,r;if(e.derror)return t.parent.error(__("Cannot fetch system locales: {0}",e.error));for(n=0,s=(i=e.result).length;n<s;n++)(r=i[n]).text=r.filename.replace(/\.json$/g,""),r.selected=r.text===t.parent.systemsetting.system.locale;return t.localelist=e.result,t.lglist.set("items",t.localelist)}))},e}(),i=function(t){function e(t,n){var s;e.__super__.constructor.call(this,t,n),s=this,this.srvlist=this.find("srvlist"),this.applist=this.find("applist"),this.srvlist.set("buttons",[{text:"+",onbtclick:function(t){var e,n,i,r,a,p;for(e in i=[],n=s.parent.systemsetting.system.packages)(a=n[e]).services&&(r=function(){var t,n,s,i;for(i=[],t=0,n=(s=a.services).length;t<n;t++)p=s[t],i.push({text:e+"/"+p,iconclass:"fa fa-tasks"});return i}(),i=i.concat(r));return s.parent.openDialog(s.mkdialog(),function(t){return s.parent.systemsetting.system.startup.services.push(t),s.render()},"__(Add service)",i)}},{text:"-",onbtclick:function(t){var e;if((e=s.srvlist.get("selidx"))>=0)return s.parent.systemsetting.system.startup.services.splice(e,1),s.render()}}]),this.applist.set("buttons",[{text:"+",onbtclick:function(t){var e,n,i;return e=function(){var t,e;for(n in e=[],t=s.parent.systemsetting.system.packages)i=t[n],e.push({text:n,iconclass:i.iconclass});return e}(),s.parent.openDialog(s.mkdialog(),function(t){return s.parent.systemsetting.system.startup.apps.push(t),s.render()},"__(Add application)",e)}},{text:"-",onbtclick:function(t){var e;if((e=s.applist.get("selidx"))>=0)return s.parent.systemsetting.system.startup.apps.splice(e,1),s.render()}}])}return a(e,s),e.prototype.render=function(){var t;return this.srvlist.set("items",function(){var e,n,s,i;for(i=[],e=0,n=(s=this.parent.systemsetting.system.startup.services).length;e<n;e++)t=s[e],i.push({text:t});return i}.call(this)),this.applist.set("items",function(){var e,n,s,i;for(i=[],e=0,n=(s=this.parent.systemsetting.system.startup.apps).length;e<n;e++)t=s[e],i.push({text:t});return i}.call(this))},e.prototype.mkdialog=function(){return this.parent._gui.mkdialog({name:"StartupDialog",layout:{tags:[{tag:"afx-list-view"}],width:250,height:200,resizable:!1,buttons:[{label:"__(Ok)",onclick:function(t){var e;return(e=t.find("content0").get("selected"))?(t.handler&&t.handler(e.text),t.quit()):t.error(__("Please select an entry"))}},{label:"__(Cancel)",onclick:function(t){return t.quit()}}],filldata:function(t){if(t.data)return t.find("content0").set("items",t.data)}}})},e}()}).call(this);