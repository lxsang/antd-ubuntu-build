(function(){var t,i,e,n,s,o=function(t,i){for(var e in i)r.call(i,e)&&(t[e]=i[e]);function n(){this.constructor=t}return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},r={}.hasOwnProperty;t=function(t){function i(t){i.__super__.constructor.call(this,"Calendar",t),this.text="",this.iconclass="fa fa-calendar"}return o(i,t),i.prototype.init=function(){var i;return(i=this).watch(1e3,function(){var t;return t=new Date,i.text=t.toString(),i.update()})},i.prototype.awake=function(t){return this.openDialog("CalendarDialog",function(t){return console.log(t)},"Calendar")},i.prototype.cleanup=function(t){return console.log("cleanup for quit")},i}(this.OS.GUI.BaseService),this.OS.register("Calendar",t),(i=function(t){function i(t){i.__super__.constructor.call(this,"PushNotification",t),this.iconclass="fa fa-bars",this.onmenuselect=function(t){return console.log(t)},this.cb=void 0,this.pending=[]}return o(i,t),i.prototype.init=function(){return this.view=!1,this._gui.htmlToScheme(i.scheme,this,this.host)},i.prototype.spin=function(t){return t&&"fa fa-bars"===this.iconclass?(this.iconclass="fa fa-spinner fa-spin",this.color="#f90e00",this.update()):t||"fa fa-spinner fa-spin"!==this.iconclass?void 0:(this.iconclass="fa fa-bars",this.color="#414339",this.update())},i.prototype.main=function(){var e;return(e=this).mlist=this.find("notifylist"),this.mfeed=this.find("notifeed"),this.nzone=this.find("notifyzone"),this.fzone=this.find("feedzone"),this.find("btclear").set("onbtclick",function(t){return e.mlist.set("items",[])}),this.subscribe("notification",function(t){return e.pushout("INFO",t)}),this.subscribe("fail",function(t){return e.pushout("FAIL",t)}),this.subscribe("error",function(t){return e.pushout("ERROR",t)}),this.subscribe("info",function(t){return e.pushout("INFO",t)}),this.subscribe("VFS",function(t){return e.pushout("INFO",t)}),this.subscribe("loading",function(t){return e.pending.push(t.id),e.spin(!0)}),this.subscribe("loaded",function(t){var i;if(0<=(i=e.pending.indexOf(t.id))&&e.pending.splice(i,1),0===e.pending.length)return e.spin(!1)}),$(this.nzone).css("right",0).css("top","-3px").css("height","").css("bottom","0").css("z-index",1e6).hide(),$(this.fzone).css("bottom","0").css("height","").hide()},i.prototype.pushout=function(t,i,e){var n;return n={text:"["+t+"] "+i.name+" ("+i.id+"): "+i.data.m,icon:i.data.icon,iconclass:i.data.iconclass,closable:!0},this.mlist.unshift(n,!0),this.notifeed(n)},i.prototype.notifeed=function(t){var i,e;return(i=this).mfeed.unshift(t,!0),$(this.fzone).show(),e=setTimeout(function(){return i.mfeed.remove(t,!0),clearTimeout(e)},3e3)},i.prototype.awake=function(t){var i;return this.view?$(this.nzone).hide():$(this.nzone).show(),this.view=!this.view,(i=this).cb||(this.cb=function(t){if(!t.originalEvent.item||void 0===t.originalEvent.item.i)return $(t.target).closest($(i.nzone)).length||$(t.target).closest($(i.holder.root)).length?void 0:($(i.nzone).hide(),$(document).unbind("click",i.cb),i.view=!i.view)}),this.view?$(document).on("click",this.cb):$(document).unbind("click",this.cb)},i.prototype.cleanup=function(t){},i}(this.OS.GUI.BaseService)).scheme='<afx-dummy>\n    <afx-overlay data-id = "notifyzone" width = "250">\n        <afx-button text = "__(Clear all)" data-id = "btclear"></afx-button>\n        <afx-list-view data-id="notifylist"></afx-list-view>\n    </afx-overlay>\n    <afx-overlay data-id = "feedzone" width = "250">\n        <afx-list-view data-id = "notifeed">\n        </afx-list-view>\n    </afx-overlay>\n</afx-dummy>',this.OS.register("PushNotification",i),(n=function(t){function i(){i.__super__.constructor.call(this,"SpotlightDialog")}return o(i,t),i.prototype.init=function(){return this._gui.htmlToScheme(i.scheme,this,this.host)},i.prototype.main=function(){var i;return(i=this).height=$(this.scheme).css("height"),this.container=this.find("container"),$(this.scheme).css("height","45px"),this.fn=function(t){if(27===t.which)return $(document).unbind("click",i.fn1),$(document).unbind("keyup",i.fn),i.handler&&i.handler(t),i.quit()},$(document).keyup(this.fn),this.fn1=function(t){if(!$(t.target).closest(i.parent.holder.root).length)return $(t.target).closest(i.scheme).length?void 0:($(document).unbind("click",i.fn1),$(document).unbind("keyup",i.fn),i.handler&&i.handler(t),i.quit())},$(document).click(this.fn1),this.searchbox=this.find("searchbox"),$(this.searchbox).focus(),$(this.searchbox).keyup(function(t){return i.search(t)}),this.container.set("onlistdbclick",function(t){if(!t.data.dataid||"header"!==t.data.dataid)return i.handler&&i.handler(t),i._gui.openWith(t.data),$(document).unbind("click",i.fn1),$(document).unbind("keyup",i.fn),i.quit()})},i.prototype.search=function(t){var i,e,n;switch(t.which){case 37:return t.preventDefault();case 38:return this.container.selectPrev(),t.preventDefault();case 39:return t.preventDefault();case 40:return this.container.selectNext(),t.preventDefault();case 13:if(t.preventDefault(),!(e=this.container.get("selected")))return;if(e.dataid&&"header"===e.dataid)return;return this.handler&&this.handler(t),this._gui.openWith(e),$(document).unbind("click",this.fn1),$(document).unbind("keyup",this.fn),this.quit();default:if(n=this.searchbox.value,$(this.scheme).css("height","45px"),!(3<=n.length))return;if(0===(i=this._api.search(n)).length)return;return this.container.set("items",i),$(this.scheme).css("height",this.height)}},i}(this.OS.GUI.BaseDialog)).scheme='<afx-app-window data-id = "spotlight-win" apptitle="" minimizable="false" resizable = "false" width="500" height="300">\n    <afx-vbox>\n        <afx-hbox data-height="45">\n            <div data-id = "searchicon" data-width="45"></div>\n            <input type = "text" data-id="searchbox"/>\n        </afx-hbox>\n        <afx-list-view data-id="container"></afx-list-view>\n    </afx-vbox>\n</afx-app-window>',this.OS.register("SpotlightDialog",n),e=function(t){function i(t){i.__super__.constructor.call(this,"Spotlight",t),this.iconclass="fa fa-search",this.show=!1}return o(i,t),i.prototype.init=function(){var i;return(i=this)._gui.bindKey("CTRL- ",function(t){return i.awake(t)})},i.prototype.main=function(){},i.prototype.awake=function(t){var i;return(i=this).show?(i.show=!1,this.dialog?this.dialog.quit():void 0):(i.show=!0,this.openDialog("SpotlightDialog",function(t){return i.show=!1,i.dialog=void 0}))},i.prototype.cleanup=function(t){},i}(this.OS.GUI.BaseService),this.OS.register("Spotlight",e),s=function(t){function i(t){i.__super__.constructor.call(this,"UserService",t),this.text=this.systemsetting.user.username,this.iconclass=void 0}return o(i,t),i.prototype.init=function(){var i;return(i=this).child=[{text:"__(About)",dataid:"user-about",iconclass:"fa fa-user-circle-o"},{text:"__(Logout)",dataid:"sys-logout",iconclass:"fa fa-user-times"}],this.onmenuselect=function(t){return"sys-logout"===t.item.data.dataid?window.OS.exit():i.notify(__("This feature is not implemented yet"))}},i.prototype.awake=function(t){},i.prototype.cleanup=function(t){},i}(this.OS.GUI.BaseService),this.OS.register("UserService",s)}).call(this);